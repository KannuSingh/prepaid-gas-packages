# PrepaidGasPaymaster Client

The main client for interacting with PrepaidGas paymasters.

## Creating a Client

```typescript
import { PrepaidGasPaymaster } from '@prepaid-gas/core'

// For Base Sepolia
const paymaster = PrepaidGasPaymaster.createForNetwork(84532)

// With custom options
const paymaster = PrepaidGasPaymaster.createForNetwork(84532, {
  subgraphUrl: 'https://custom-subgraph-url.com'
})
```

## Main Methods

### getPaymasterStubData()

For gas estimation - fast, no ZK proof generation:

```typescript
const stubData = await paymaster.getPaymasterStubData({
  sender: '0x1234...', // smart account address
  callData: '0xabcd...', // encoded function call
  context: encodedContext, // paymaster context
  chainId: 84532,
  entryPointAddress: '0x0000000071727De22E5E9d8BAf0edAc6f37da032'
})
```

### getPaymasterData()

For real transactions - generates ZK proof:

```typescript
const paymasterData = await paymaster.getPaymasterData({
  sender: '0x1234...',
  nonce: 1n,
  callData: '0xabcd...',
  callGasLimit: 100000n,
  verificationGasLimit: 200000n,
  preVerificationGas: 50000n,
  maxFeePerGas: 1000000000n,
  maxPriorityFeePerGas: 1000000000n,
  context: encodedContext
})
```

## Integration with Smart Account

```typescript
import { createSmartAccountClient } from 'permissionless'

// Create paymaster client
const paymasterClient = PrepaidGasPaymaster.createForNetwork(84532)

// Configure smart account client
const smartAccountClient = createSmartAccountClient({
  client: publicClient,
  account: smartAccount,
  bundlerTransport: http('your-bundler-url'),
  // Add paymaster configuration
  paymaster: {
    getPaymasterStubData: paymasterClient.getPaymasterStubData.bind(paymasterClient),
    getPaymasterData: paymasterClient.getPaymasterData.bind(paymasterClient),
  },
  paymasterContext: encodedContext // your paymaster context
})
```

## Context Format

```typescript
import { encodePaymasterContext } from '@prepaid-gas/core'

const context = encodePaymasterContext(
  '0x4DACA5b0a5d10853F84bB400C5232E4605bc14A0', // paymaster address
  identity.export() // Semaphore identity string
)
```

## Supported Paymasters

```typescript
const paymasters = paymaster.getSupportedPaymasters()
// Returns: [{ address: '0x...', type: 'OneTimeUse' }, ...]
```

## Error Handling

```typescript
try {
  const result = await paymaster.getPaymasterData(params)
} catch (error) {
  console.error('Paymaster failed:', error.message)
}
```